1) Зачем вот это System.setProperty в начале
Устанавливает переменную среды HADOOP_HOME на уровне программы (можно на уровне операционной системы)
2) Что такое KryoSerializer
Spark также может использовать библиотеку Kryo (версия 4) для более быстрой сериализации объектов. 
Kryo значительно быстрее и компактнее, чем сериализация Java (часто до 10 раз), но не поддерживает 
все Serializable типы и требует предварительной регистрации классов, которые вы будете использовать 
в программе, для лучшей производительности.
3) sql.shuffle.partitions
настраивает количество partitions, которые используются при shuffling (процесс передачи промежуточных 
данных из mapper'ов в reducer) данных для соединений или агрегации.
4) config.master("local[*]") - запускает Spark локально, используя столько рабочих потоков, 
сколько логических ядер на вашем компьютере.
